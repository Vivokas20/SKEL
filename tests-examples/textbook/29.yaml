db: tests-examples/textbook/tables/29.sqlite
inputs:
  - tests-examples/textbook/tables/aircraft.txt
  - tests-examples/textbook/tables/flights.txt
output: tests-examples/textbook/tables/29.out
constants:
  - Los Angeles
  - Chicago
functions:
  - min
columns:
  - origin
  - destination
  - distance
  - crusingrange
sql: |
  SELECT A.aid
  FROM Aircraft A
  WHERE A.crusingrange > ( SELECT MIN (F.distance)
                            FROM Flights F
                            WHERE F.origin = 'Los Angeles' AND F.destination = 'Chicago' )
comment: |
  5.3.6 optimal solution sql

full_sketch: |
  T1 = filter(flights, origin == 'Los Angeles' & destination == 'Chicago')
  T2 = summarise(T1, distance = min(distance))
  T3 = natural_join(aircraft, T2)
  T4 = filter(T3, crusingrange > distance)
  out = select(aid)