db: tests-examples/textbook/tables/26.sqlite
inputs:
  - tests-examples/textbook/tables/employees.txt
  - tests-examples/textbook/tables/flights.txt
output: tests-examples/textbook/tables/26.out
constants:
  - Los Angeles
  - Honolulu
functions:
  - min
columns:
  - origin
  - destination
  - price
  - salary
bools:
  - <
loc: 4
solution:
  - filter
  - union
  - mutate
  - filter
sql: |
  SELECT DISTINCT E.ename
  FROM employees E
  WHERE E.salary < (SELECT min(F.price)
                    FROM flights F
                    WHERE F.origin = "Los Angeles"
                      AND F.destination = "Honolulu")
comment: |
  5.3.3 optimal solution sql

full_sketch: |
  T1 = filter(flights, origin == 'Los Angeles' & destination == 'Honolulu')
  T2 = summarise(T1, price = min(price))
  T3 = natural_join(employees, T2)
  T4 = filter(T3, salary < price)
  out = select distinct(ename)