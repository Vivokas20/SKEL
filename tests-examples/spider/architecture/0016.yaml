db: tests-examples/spider/architecture/tables/db.sqlite
inputs:
- tests-examples/spider/architecture/tables/architect.csv
- tests-examples/spider/architecture/tables/mill.csv
output: tests-examples/spider/architecture/tables/0016.csv
constants:
- '1850'
functions:
- count
columns:
- id
- built_year
comment: |-
  SELECT count(*)
  FROM architect
  WHERE id NOT IN
      (SELECT architect_id
       FROM mill
       WHERE built_year < 1850 );

  df4 <- df_mill %>% filter(built_year < 1850)
  df5 <- intersect(select(df_architect,gender), select(df_architect, gender))
  df6 <- df5 %>% group_by() %>% summarise(n = n()) %>% ungroup()
  out <- df6 %>% select(count___ = n)


sql: |-
  SELECT count(*)
  FROM architect
  WHERE id NOT IN
      (SELECT architect_id
       FROM mill
       WHERE built_year < 1850 );