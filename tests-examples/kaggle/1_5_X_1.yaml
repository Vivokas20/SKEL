inputs:
  - tests-examples/kaggle/tables/taxi_trips.csv
output: tests-examples/kaggle/tables/1_5_X_1.csv
functions:
  - n
loc: 1
sql:
  SELECT EXTRACT(YEAR FROM trip_start_timestamp) AS year,
  COUNT(1) AS num_trips
  FROM `bigquery-public-data.chicago_taxi_trips.taxi_trips`
  GROUP BY year
  ORDER BY year
comment:
  df1 <- df_transactions %>% group_by(block_timestamp,size) %>% summarise(n = n()) %>% ungroup()
  out <- df1 %>% select(transactions = n, trans_date = block_timestamp) %>% arrange(transactions)
